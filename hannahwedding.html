<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Todo List</title>
</head>
<body>
<h1>Todo List</h1>
<ol id="todolist">

</ol>

<form name="myform" role="form">
Task: <input type=text name='description'>
<select name='priority'>
    <option value=high>High</option>
    <option value=medium>Medium</option>
    <option value=low>Low</option>
</select>
Due: <input type=text name='duedate'>
<INPUT TYPE="button" NAME="button" Value="Click" onClick="addtask(this.form)">
</form>



<script type="text/javascript">
    function showtodos() {
        var obj = new XMLHttpRequest();
        obj.open("GET", "/todo", true);
        obj.onreadystatechange = function () {
            if (obj.readyState == 4 && obj.status == 200) {
                tododb = JSON.parse(obj.responseText);
                ol = document.createElement("ol");
                for(i in tododb.tasklist) {
                    li = document.createElement("li");
                    li.innerHTML = tododb.tasklist[i].task;
                    ol.appendChild(li);
                }
                document.body.appendChild(ol);
            }
        }
        obj.send()
    }



    function addtask(form)  {
        alert("You successfully added a new task to the database");
        var obj = new XMLHttpRequest();
        obj.open("POST", "/todo/post", true);
        var description = form.description.value;
        var priority = form.priority.value;
        var duedate = form.duedate.value;


        obj.send(JSON.stringify({task:description, priority:priority, due:duedate}));


    }

</script>
<button onclick="showtodos();">Show all tasks</button>
</body>
</html>
